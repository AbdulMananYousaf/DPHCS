@model IEnumerable<DistributedPatientHealthCareSystem.DPHCSModels.Employee>


@{
    ViewData["Title"] = "Index";
    Layout = "_AdminLayout";
}

<div class="row">
    <p>
        <a asp-action="Create">Create New</a>
    </p>
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                DataTables Advanced Tables
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <table class="table table-responsive table-striped table-bordered table-hover" id="mytable" name="mytable">
                    <thead>
                        <tr>
                         
                            <th>
                                @Html.DisplayNameFor(model => model.EmployeeNavigation.PersonId)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.EmployeeNavigation.FirstName)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.EmployeeNavigation.LastName)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.EmployeeNavigation.Gender)
                            </th>


                            <th>
                                @Html.DisplayNameFor(model => model.Spectialization)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Status)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.EmployeeNavigation.PersonNavigation.Role)
                            </th>

                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                       
                        @foreach (var item in Model)
                        {
                            <tr>
                               
                                <td>
                                    @Html.DisplayFor(modelItem => item.EmployeeNavigation.PersonId)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.EmployeeNavigation.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.EmployeeNavigation.LastName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.EmployeeNavigation.Gender)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Spectialization)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Status)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.EmployeeNavigation.PersonNavigation.Role)
                                </td>
                                <td>
                                    <a asp-action="Edit" asp-route-id="@item.EmployeeId" >Edit</a> |
                                    <a asp-action="Details" asp-route-id="@item.EmployeeId">Details</a> |
                                    <a  data-id=@item.EmployeeId  href="#"  >Delete</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                </div>
            </div>
        </div>
    </div>
               
                <link href="~/lib/theme/vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet" />
                <link href="~/lib/theme/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

                <link href="~/lib/theme/vendor/metisMenu/metisMenu.min.css" rel="stylesheet" />

                <link href="~/lib/theme/vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet" />

                <link href="~/lib/theme/vendor/datatables-responsive/dataTables.responsive.css" rel="stylesheet" />

                <link href="~/lib/theme/dist/css/sb-admin-2.css" rel="stylesheet" />

                <link href="~/lib/theme/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />



@section Scripts{
<script src="~/lib/theme/vendor/metisMenu/metisMenu.min.js"></script>
<script src="~/lib/theme/vendor/datatables/js/jquery.dataTables.min.js"></script>
<script src="~/lib/theme/vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
<script src="~/lib/theme/vendor/datatables-responsive/dataTables.responsive.js"></script>

@* alertify Start *@
<link href="~/lib/alertifyjs/css/alertify.css" rel="stylesheet" />
<script src="~/lib/alertifyjs/alertify.js"></script>
<link href="~/lib/alertifyjs/css/themes/bootstrap.css" rel="stylesheet" />
<link href="~/lib/alertifyjs/css/themes/default.css" rel="stylesheet" />
<link href="~/lib/alertifyjs/css/themes/semantic.css" rel="stylesheet" />
@* alertify End *@
<script>

    $(function () {       
        var deletebutttonid = "";
        var deletebutton = "";
        var errorHeader = '<span class="fa fa-trash fa-1x" '
            + 'style="vertical-align:middle;color:#e10000;">'
            + '</span>  <text id="themecolor"> Employee Delete</text>';
            $("a").on("click",
                function () {
                    deletebutton = $(this);
                    var value = $(this).html();
                    //alert(value);
                    if (value =="Delete") {
                        deletebutttonid = $(this).data("id");
                        alertify.confirm("<text id='themecolor'>Are You Sure to Delete All Record of Employee.</text>",
                            function () {
                                deletefun();
                            }
                        ).setHeader(errorHeader);
                    }
                }
            );
            
           
            function deletefun() {               
                $.ajax({
                    beforeSend: function () {
                                        
                    },
                    url: "/Employee/Delete?id=" + deletebutttonid,
                    type: "POST",
                    error: function () {
                        alertify.error("Error:Somthing bad happen");
                    },
                    success: function (result) {
                        if (result == "1") {
                            
                            alertify.success("Record Succesfully Deleted")
                            deletebutton.parent().parent().fadeOut();

                         }
                        if(result=="0") { 
                            alertify.error("Error:Somthing bad happen");
                        } 
                       
                    },
                    data: function (result) {
                      
                    },
                    complete: function (result) {
                      
                    }

                });
              
            }
        
        $("#mytable").DataTable();

    });

</script>
}
